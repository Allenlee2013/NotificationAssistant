# 邮件通知功能使用指南

## 功能说明

通知小助手已支持邮件通知功能，当您勾选"邮件通知"后，收到新消息时会自动给自己发送邮件提醒。

## 配置步骤

### 1. 安装依赖

在客户端目录安装nodemailer：

```bash
cd client
npm install nodemailer
```

### 2. 启用邮件通知

在"系统设置"中勾选"邮件通知"。

### 3. 配置邮件

点击"配置SMTP服务器"按钮，按照以下步骤配置：

#### 第一步：选择邮箱服务商

系统已内置常用邮箱配置：
- QQ邮箱
- 163网易邮箱
- Gmail
- Outlook
- 自定义

#### 第二步：填写邮箱信息

**QQ邮箱**
- 邮箱：您的QQ邮箱（如：123456@qq.com）
- 授权码：在QQ邮箱设置中获取

**获取QQ邮箱授权码：**
1. 登录QQ邮箱网页版
2. 点击"设置" → "账户"
3. 找到"POP3/IMAP/SMTP/Exchange/CardDAV/CalDAV服务"
4. 开启"POP3/SMTP服务"或"IMAP/SMTP服务"
5. 按提示发送短信，获取授权码

**163网易邮箱**
- 邮箱：您的163邮箱（如：yourname@163.com）
- 授权码：在163邮箱设置中获取

**Gmail**
- 邮箱：您的Gmail地址（如：yourname@gmail.com）
- 授权码：Google应用专用密码

**获取Gmail应用专用密码：**
1. 登录Google账户
2. 进入"安全性"设置
3. 启用"两步验证"
4. 在"应用专用密码"中生成一个新密码

**Outlook**
- 邮箱：您的Outlook邮箱（如：yourname@outlook.com）
- 授权码：您的Microsoft账户密码

**自定义邮箱**
- 邮箱：您的邮箱地址
- 授权码：邮箱密码或授权码
- SMTP服务器：自定义SMTP服务器地址
- 端口：SMTP端口（默认587）

#### 第三步：测试邮件

配置完成后，点击"保存配置"。系统会自动发送一封测试邮件到您的邮箱，检查是否能正常收到。

## 使用说明

### 邮件发送规则

- 邮件发送到您配置的邮箱（自己给自己发）
- 每收到一条新消息就会发送一封邮件
- 定时消息到期时也会发送邮件提醒

### 邮件内容格式

- 主题：`[消息主题] 新消息`
- 内容：发送者、消息内容、发送时间

### 开启/关闭邮件通知

- 勾选"邮件通知"：启用邮件提醒
- 取消勾选"邮件通知"：关闭邮件提醒

## 注意事项

1. **安全性**
   - 授权码会加密保存在本地
   - 建议使用授权码而非登录密码
   - 不要在公共场所配置邮箱

2. **发送频率**
   - 每条消息都会发送邮件，注意邮件数量

3. **网络要求**
   - 需要能访问SMTP服务器
   - 部分公司网络可能限制SMTP端口

4. **垃圾邮件**
   - 自动发送的邮件可能被标记为垃圾邮件
   - 建议将发送邮箱添加到白名单

## 故障排查

### 无法发送邮件

1. **检查邮箱服务商**
   - 确认选择的邮箱服务商正确

2. **检查授权码**
   - 确认使用的是授权码而非登录密码
   - 重新生成授权码尝试

3. **检查网络连接**
   - 确认能访问互联网
   - 部分网络可能限制SMTP端口

4. **查看日志**
   - 打开开发者工具（Ctrl+Shift+I）
   - 查看Console中的错误信息

### 收不到测试邮件

1. 检查垃圾邮件文件夹
2. 确认邮箱地址输入正确
3. 尝试重新配置授权码
4. 更换邮箱服务商尝试

## 常见问题

**Q: 为什么需要授权码？**
A: 为了保护账户安全，QQ、163等邮箱禁止使用登录密码登录第三方客户端，必须使用授权码。

**Q: Gmail无法发送邮件？**
A: 需要先开启两步验证，然后生成应用专用密码。

**Q: 邮件发送失败怎么办？**
A: 检查授权码是否正确，查看错误日志，尝试重新生成授权码。

**Q: 可以发送到其他邮箱吗？**
A: 目前只支持发送到配置的邮箱（自己给自己发），以确保隐私和安全。

**Q: 配置会保存在哪里？**
A: 配置保存在本地，Windows系统通常在 `C:\Users\用户名\AppData\Roaming\pubsub-notification-assistant` 目录。

**Q: 可以关闭邮件通知吗？**
A: 可以，在系统设置中取消勾选"邮件通知"即可。

## 技术支持

如遇到问题，请提供以下信息：
1. 邮箱服务商（QQ、163、Gmail等）
2. 错误提示信息
3. 开发者工具Console中的日志

## 更新日志

### v1.1.0
- 精简配置流程，支持预设邮箱服务商
- 邮件发送到自己的邮箱
- 优化用户体验

### v1.0.0
- 新增邮件通知功能
- 支持自定义SMTP服务器配置
- 支持测试邮件发送

